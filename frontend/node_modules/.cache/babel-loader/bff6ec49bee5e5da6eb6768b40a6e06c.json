{"ast":null,"code":"import _slicedToArray from \"/Users/alberttian/f21/playground/frontend/fencing-ai-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\nimport { ResizeBilinear, util } from '@tensorflow/tfjs-core';\nimport { cast } from './Cast';\nvar wasmResizeBilinear;\n\nfunction setup(backend) {\n  wasmResizeBilinear = backend.wasm.cwrap(ResizeBilinear, null\n  /*void*/\n  , ['number', 'number', 'number', 'number', 'number', 'number', 'number', 'number', 'number', 'number' // outId\n  ]);\n}\n\nfunction resizeBilinear(args) {\n  var backend = args.backend,\n      inputs = args.inputs,\n      attrs = args.attrs;\n  var images = inputs.images;\n  var alignCorners = attrs.alignCorners,\n      halfPixelCenters = attrs.halfPixelCenters,\n      size = attrs.size;\n\n  var _size = _slicedToArray(size, 2),\n      newHeight = _size[0],\n      newWidth = _size[1];\n\n  var _images$shape = _slicedToArray(images.shape, 4),\n      batch = _images$shape[0],\n      oldHeight = _images$shape[1],\n      oldWidth = _images$shape[2],\n      numChannels = _images$shape[3];\n\n  var outShape = [batch, newHeight, newWidth, numChannels];\n  var xData = backend.dataIdMap.get(images.dataId);\n  var castedData;\n\n  if (xData.dtype !== 'float32') {\n    castedData = cast({\n      backend: backend,\n      inputs: {\n        x: images\n      },\n      attrs: {\n        dtype: 'float32'\n      }\n    });\n    xData = backend.dataIdMap.get(castedData.dataId);\n  }\n\n  var xId = xData.id;\n  var out = backend.makeOutput(outShape, 'float32');\n\n  if (util.sizeFromShape(images.shape) === 0) {\n    return out;\n  }\n\n  var outId = backend.dataIdMap.get(out.dataId).id;\n  wasmResizeBilinear(xId, batch, oldHeight, oldWidth, numChannels, newHeight, newWidth, alignCorners ? 1 : 0, halfPixelCenters ? 1 : 0, outId);\n\n  if (castedData != null) {\n    backend.disposeData(castedData.dataId);\n  }\n\n  return out;\n}\n\nexport var resizeBilinearConfig = {\n  kernelName: ResizeBilinear,\n  backendName: 'wasm',\n  setupFunc: setup,\n  kernelFunc: resizeBilinear\n};","map":{"version":3,"sources":["../../src/kernels/ResizeBilinear.ts"],"names":[],"mappings":";;AAAA;;;;;;;;;;;;;;;AAeG;AAEH,SAAkC,cAAlC,EAAyG,IAAzG,QAAoH,uBAApH;AAIA,SAAQ,IAAR,QAAmB,QAAnB;AAEA,IAAI,kBAAJ;;AAKA,SAAS,KAAT,CAAe,OAAf,EAAmC;AACjC,EAAA,kBAAkB,GAAG,OAAO,CAAC,IAAR,CAAa,KAAb,CAAmB,cAAnB,EAAmC;AAAK;AAAxC,IAAkD,CACrE,QADqE,EAErE,QAFqE,EAGrE,QAHqE,EAIrE,QAJqE,EAKrE,QALqE,EAMrE,QANqE,EAOrE,QAPqE,EAQrE,QARqE,EASrE,QATqE,EAUrE,QAVqE,CAU1D;AAV0D,GAAlD,CAArB;AAYD;;AAED,SAAS,cAAT,CAAwB,IAAxB,EAIC;AAAA,MACQ,OADR,GACkC,IADlC,CACQ,OADR;AAAA,MACiB,MADjB,GACkC,IADlC,CACiB,MADjB;AAAA,MACyB,KADzB,GACkC,IADlC,CACyB,KADzB;AAAA,MAGQ,MAHR,GAGkB,MAHlB,CAGQ,MAHR;AAAA,MAIQ,YAJR,GAIgD,KAJhD,CAIQ,YAJR;AAAA,MAIsB,gBAJtB,GAIgD,KAJhD,CAIsB,gBAJtB;AAAA,MAIwC,IAJxC,GAIgD,KAJhD,CAIwC,IAJxC;;AAAA,6BAK+B,IAL/B;AAAA,MAKQ,SALR;AAAA,MAKmB,QALnB;;AAAA,qCAOmD,MAAM,CAAC,KAP1D;AAAA,MAOQ,KAPR;AAAA,MAOe,SAPf;AAAA,MAO0B,QAP1B;AAAA,MAOoC,WAPpC;;AAQC,MAAM,QAAQ,GAAG,CAAC,KAAD,EAAQ,SAAR,EAAmB,QAAnB,EAA6B,WAA7B,CAAjB;AAEA,MAAI,KAAK,GAAG,OAAO,CAAC,SAAR,CAAkB,GAAlB,CAAsB,MAAM,CAAC,MAA7B,CAAZ;AACA,MAAI,UAAJ;;AACA,MAAI,KAAK,CAAC,KAAN,KAAgB,SAApB,EAA+B;AAC7B,IAAA,UAAU,GACN,IAAI,CAAC;AAAC,MAAA,OAAO,EAAP,OAAD;AAAU,MAAA,MAAM,EAAE;AAAC,QAAA,CAAC,EAAE;AAAJ,OAAlB;AAA+B,MAAA,KAAK,EAAE;AAAC,QAAA,KAAK,EAAE;AAAR;AAAtC,KAAD,CADR;AAEA,IAAA,KAAK,GAAG,OAAO,CAAC,SAAR,CAAkB,GAAlB,CAAsB,UAAU,CAAC,MAAjC,CAAR;AACD;;AACD,MAAM,GAAG,GAAG,KAAK,CAAC,EAAlB;AAEA,MAAM,GAAG,GAAG,OAAO,CAAC,UAAR,CAAmB,QAAnB,EAA6B,SAA7B,CAAZ;;AACA,MAAI,IAAI,CAAC,aAAL,CAAmB,MAAM,CAAC,KAA1B,MAAqC,CAAzC,EAA4C;AAC1C,WAAO,GAAP;AACD;;AACD,MAAM,KAAK,GAAG,OAAO,CAAC,SAAR,CAAkB,GAAlB,CAAsB,GAAG,CAAC,MAA1B,EAAkC,EAAhD;AAEA,EAAA,kBAAkB,CACd,GADc,EACT,KADS,EACF,SADE,EACS,QADT,EACmB,WADnB,EACgC,SADhC,EAC2C,QAD3C,EAEd,YAAY,GAAG,CAAH,GAAO,CAFL,EAEQ,gBAAgB,GAAG,CAAH,GAAO,CAF/B,EAEkC,KAFlC,CAAlB;;AAIA,MAAI,UAAU,IAAI,IAAlB,EAAwB;AACtB,IAAA,OAAO,CAAC,WAAR,CAAoB,UAAU,CAAC,MAA/B;AACD;;AAED,SAAO,GAAP;AACD;;AAED,OAAO,IAAM,oBAAoB,GAAiB;AAChD,EAAA,UAAU,EAAE,cADoC;AAEhD,EAAA,WAAW,EAAE,MAFmC;AAGhD,EAAA,SAAS,EAAE,KAHqC;AAIhD,EAAA,UAAU,EAAE;AAJoC,CAA3C","sourcesContent":["/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nimport {KernelConfig, KernelFunc, ResizeBilinear, ResizeBilinearAttrs, ResizeBilinearInputs, TensorInfo, util} from '@tensorflow/tfjs-core';\n\nimport {BackendWasm} from '../backend_wasm';\n\nimport {cast} from './Cast';\n\nlet wasmResizeBilinear: (\n    xId: number, batch: number, oldHeight: number, oldWidth: number,\n    numChannels: number, newHeight: number, newWidth: number,\n    alignCorners: number, halfPixelCenters: number, outId: number) => void;\n\nfunction setup(backend: BackendWasm): void {\n  wasmResizeBilinear = backend.wasm.cwrap(ResizeBilinear, null /*void*/, [\n    'number',  // xId\n    'number',  // batch\n    'number',  // oldHeight\n    'number',  // oldWidth\n    'number',  // numChannels\n    'number',  // newHeight\n    'number',  // newWidth\n    'number',  // alignCorners\n    'number',  // halfPixelCenters\n    'number'   // outId\n  ]);\n}\n\nfunction resizeBilinear(args: {\n  backend: BackendWasm,\n  inputs: ResizeBilinearInputs,\n  attrs: ResizeBilinearAttrs\n}): TensorInfo {\n  const {backend, inputs, attrs} = args;\n\n  const {images} = inputs;\n  const {alignCorners, halfPixelCenters, size} = attrs;\n  const [newHeight, newWidth] = size;\n\n  const [batch, oldHeight, oldWidth, numChannels] = images.shape;\n  const outShape = [batch, newHeight, newWidth, numChannels];\n\n  let xData = backend.dataIdMap.get(images.dataId);\n  let castedData;\n  if (xData.dtype !== 'float32') {\n    castedData =\n        cast({backend, inputs: {x: images}, attrs: {dtype: 'float32'}});\n    xData = backend.dataIdMap.get(castedData.dataId);\n  }\n  const xId = xData.id;\n\n  const out = backend.makeOutput(outShape, 'float32');\n  if (util.sizeFromShape(images.shape) === 0) {\n    return out;\n  }\n  const outId = backend.dataIdMap.get(out.dataId).id;\n\n  wasmResizeBilinear(\n      xId, batch, oldHeight, oldWidth, numChannels, newHeight, newWidth,\n      alignCorners ? 1 : 0, halfPixelCenters ? 1 : 0, outId);\n\n  if (castedData != null) {\n    backend.disposeData(castedData.dataId);\n  }\n\n  return out;\n}\n\nexport const resizeBilinearConfig: KernelConfig = {\n  kernelName: ResizeBilinear,\n  backendName: 'wasm',\n  setupFunc: setup,\n  kernelFunc: resizeBilinear as {} as KernelFunc\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}